# ============================================
# DATA ENTITIES (Centralized Data Artifact Definitions)
# ============================================
data_entities:
  nl_spec:
    type: md
    filename: todo_list_nl_spec.md
    description: "Natural language requirements specification in markdown format"
    compression_strategies:
      none:
        description: "Natural language requirements specification in markdown format"

  spec:
    type: yaml
    filename: spec_1.yaml
    description: "A formal software application specification. "
    yaml_schema: schemas/spec_yaml_schema.json
    compression_strategies:
      none:
        description: >
          The complete specification with all details, in YAML format. This includes all the original text and structure from the natural language specification, organized into a structured YAML format. It serves as the foundational representation of the specification before any further processing or extraction of concepts.      
          • Hierarchical Sections (S*) which contain text_blocks, identified with anchor_id formatted as (AN*), which is refered to here as an anchor. 
          • For each anchor:
            • text (natural-language excerpt),
            • type (e.g., goal, capability, constraint, future-capability),
            • semantic_cues: A list of hint concepts: concepts: [{concept_id: Cn, name: "..."}].
          A JSON schema will be provided that describes the structure of the YAML specification.
      anchor_index:
        description: >
          A set of text block (`Anchors`) labeled AN1, AN2, AN3, etc.  Each corresponds to a block of text from the specification.
          These anchors are used to ground all other conceptual and design concepts, allowing for traceability back to the original specification text.  The `spec` output in this format includes the original text blocks and their corresponding anchors, but does not include any additional extracted concepts or relationships.
      schema_only:
        description: "schema-only format"
      yaml_as_json:
        description: >
          The complete specification with all details, in JSON format. This includes all the original text and structure from the natural language specification, organized into a structured YAML format. It serves as the foundational representation of the specification before any further processing or extraction of concepts.      
          • Hierarchical Sections (S*) which contain text_blocks, identified with anchor_id formatted as (AN*), which is refered to here as an anchor. 
          • For each anchor:
            • text (natural-language excerpt),
            • type (e.g., goal, capability, constraint, future-capability),
            • semantic_cues: A list of hint concepts: concepts: [{concept_id: Cn, name: "..."}].
      heirachical:
        description: >
          A hierarchical representation of the specification that preserves the original structure and organization of the natural language specification. This format maintains the sections, subsections, and text blocks as they appear in the original document, allowing for a more intuitive understanding of the specification's flow and organization. It includes all the original text and structure from the natural language specification, organized into a structured YAML format. It serves as the foundational representation of the specification before any further processing or extraction of concepts.          
      minimal_json:
        description: >
          YAML converted to JSON format. This is a compact representation that preserves the complete specification structure in JSON format, suitable for JSON compression strategies.
  spec_compact:
    type: yaml
    filename: spec_compact.json
    description: "Compressed specification in JSON format"
    yaml_schema: schemas/spec_yaml_schema.json
    compression_strategies:
      none:
        description: "JSON representation of the specification"
      minimal_json:
        description: "YAML converted to JSON format"

  spec_formal:
    type: md
    filename: spec_formal.md
    description: "Formal markdown specification"

  revised_spec:
    type: md
    filename: revised_spec.md
    description: "Revised formal markdown specification"

  concepts:
    type: json
    filename: concepts.json
    description: "Extracted concepts from specification"
    schema: schemas/concepts.schema.json
    compression_strategies:
      none:
        description: "Complete JSON concepts"
      concept_summary:
        description: "concept summary format (markdown tables grouped by entity type)"
      minimal_json:
        description: >
          Compressed JSON representation of concepts. This format uses field code mapping and tabular arrays to reduce context size while preserving all conceptual information.

  concepts_compact:
    type: json
    filename: concepts_compact.json
    description: "Compressed concepts in JSON format"
    schema: schemas/concepts.schema.json
    compression_strategies:
      none:
        description: "JSON representation of concepts"
      minimal_json:
        description: "Compressed JSON representation of concepts"

  aggregations:
    type: json
    filename: aggregations.json
    description: "Aggregated concept relationships"
    schema: schemas/aggregations.schema.json
    compression_strategies:
      none:
        description: "Complete JSON aggregations"
      concept_summary:
        description: "concept summary format (markdown tables grouped by entity type)"
      minimal_json:
        description: >
          Compressed JSON representation of aggregations. This format uses field code mapping and tabular arrays to reduce context size while preserving all aggregation information.

  aggregations_compact:
    type: json
    filename: aggregations_compact.json
    description: "Compressed aggregations in JSON format"
    schema: schemas/aggregations.schema.json
    compression_strategies:
      none:
        description: "JSON representation of aggregations"
      minimal_json:
        description: "Compressed JSON representation of aggregations"

  messages:
    type: json
    filename: messages.json
    description: "Message definitions"
    schema: schemas/messages.schema.json
    compression_strategies:
      none:
        description: "Complete JSON messages"
      concept_summary:
        description: "concept summary format (markdown tables grouped by entity type)"
      minimal_json:
        description: >
          Compressed JSON representation of messages. This format uses field code mapping and tabular arrays to reduce context size while preserving all message information.

  messages_compact:
    type: json
    filename: messages_compact.json
    description: "Compressed messages in JSON format"
    schema: schemas/messages.schema.json
    compression_strategies:
      none:
        description: "JSON representation of messages"
      minimal_json:
        description: "Compressed JSON representation of messages"

  message_aggregations:
    type: json
    filename: messageAggregations.json
    description: "Message aggregation definitions"
    schema: schemas/messageAggregations.schema.json
    compression_strategies:
      none:
        description: "Complete JSON message aggregations"
      minimal_json:
        description: >
          Compressed JSON representation of message aggregations. This format uses field code mapping and tabular arrays to reduce context size while preserving all aggregation information.

  message_aggregations_compact:
    type: json
    filename: messageAggregations_compact.json
    description: "Compressed message aggregations in JSON format"
    schema: schemas/messageAggregations.schema.json
    compression_strategies:
      none:
        description: "JSON representation of message aggregations"
      minimal_json:
        description: "Compressed JSON representation of message aggregations"

  requirements:
    type: json
    filename: requirements.json
    description: "Final requirements output"
    schema: schemas/requirements.schema.json
    compression_strategies:
      none:
        description: "Complete JSON requirements"
      minimal_json:
        description: >
          Compressed JSON representation of requirements. This format uses field code mapping and tabular arrays to reduce context size while preserving all requirement information.

  requirements_compact:
    type: json
    filename: requirements_compact.json
    description: "Compressed requirements in JSON format"
    schema: schemas/requirements.schema.json
    compression_strategies:
      none:
        description: "JSON representation of requirements"
      minimal_json:
        description: "Compressed JSON representation of requirements"

# ============================================
# CLI INPUTS (unchanged)
# ============================================
cli_inputs:
  - label: nl_spec
    type: md
    prompt: 'Enter your natural language specification:'
    required: true
    default_file: doc/todo_list_nl_spec.md

# ============================================
# EXOGENOUS INPUTS (unchanged)
# ============================================
exogenous_inputs:
  - file: doc/todo_list_nl_spec.md
    label: nl_spec
  - file: schemas/concept.schema.json
    label: concept_schema

# ============================================
# STEPS (Simplified - only reference labels)
# ============================================
steps:
  step1:
    name: step1
    prompt_file: prompt_step1_v2.md
    order: 1
    inputs:
      - label: nl_spec
        source: cli
        compression: none
        color: cyan
    outputs:
      - label: spec
    dependencies: []
    validation:
      enabled: false
    persona: systems_architect

  step2:
    name: step2
    prompt_file: prompt_step2_v2.md
    order: 2
    inputs:
      - label: spec
        source: label:spec
        compression: minimal_json
        color: green
    outputs:
      - label: spec_formal
    dependencies:
      - step1
    validation:
      enabled: false
    persona: software_engineer

  step3:
    name: step3
    prompt_file: prompt_step3_v2.md
    order: 3
    inputs:
      - label: spec_formal
        source: label:spec_formal
        compression: none
        color: yellow
    outputs:
      - label: revised_spec
    dependencies:
      - step2
    validation:
      enabled: false
    persona: software_engineer

  stepC3:
    name: stepC3
    prompt_file: prompt_step_C3.md
    order: 4
    inputs:
      - label: spec
        source: label:spec
        compression: minimal_json
        color: magenta
    outputs:
      - label: concepts
    dependencies:
      - step1
    validation:
      enabled: true
    persona: systems_architect

  stepC4:
    name: stepC4
    prompt_file: prompt_step_C4.md
    order: 5
    inputs:
      - label: spec
        source: label:spec
        compression: minimal_json
        color: cyan
      - label: concepts
        source: label:concepts
        compression: minimal_json
        color: green
    outputs:
      - label: aggregations
    dependencies:
      - stepC3
    validation:
      enabled: true
    persona: software_engineer

  stepC5:
    name: stepC5
    prompt_file: prompt_step_C5.md
    order: 6
    inputs:
      - label: spec
        source: label:spec
        compression: minimal_json
        color: cyan
      - label: concepts
        source: label:concepts
        compression: minimal_json
        color: green
      - label: aggregations
        source: label:aggregations
        compression: minimal_json
        color: yellow
    outputs:
      - label: messages
      - label: message_aggregations
    dependencies:
      - stepC3
      - stepC4
    validation:
      enabled: true
    persona: systems_architect

  stepD1:
    name: stepD1
    prompt_file: prompt_step_D1.md
    order: 7
    inputs:
      - label: spec
        source: label:spec
        compression: minimal_json
        color: cyan
      - label: concepts
        source: label:concepts
        compression: minimal_json
        color: green
      - label: messages
        source: label:messages
        compression: minimal_json
        color: magenta
    outputs:
      - label: requirements
    dependencies:
      - stepC3
      - stepC5
    validation:
      enabled: true
    persona: systems_engineer

# ============================================
# MODEL LEVELS (unchanged)
# ============================================
model_levels:
  step1:
    1: minimax/minimax-m2.5
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
  step2:
    1: minimax/minimax-m2.5
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
  step3:
    1: minimax/minimax-m2.5
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
  stepC3:
    1: qwen/qwen-2.5-72b
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
  stepC4:
    1: minimax/minimax-m2.5
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
  stepC5:
    1: qwen/qwen-2.5-72b
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
  stepD1:
    1: qwen/qwen-2.5-72b
    2: xiaomi/mimo-v2-flash
    3: moonshotai/kimi-k2-0905
